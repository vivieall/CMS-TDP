Power=function(){function e(e){}function t(e,t,n){void 0!==e.errorCode&&null!==e.errorCode||(e.errorCode=t),void 0!==e.errorText&&null!==e.errorText||(e.errorText=n)}function n(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;e.sort(),t.sort();for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function r(t){null===a?f.Request("luna://com.webos.service.tv.systemproperty",{method:"getSystemInfo",parameters:{keys:["sdkVersion","boardType"]},onSuccess:function(n){e("getPlatformInfo: onSuccess"),e("version : "+n.sdkVersion);var i=n.sdkVersion.split(".");l=i.length>=1&&"1"===i[0]?{webOSVer:1,chipset:n.boardType.split("_")[0]}:i.length>=1&&"2"===i[0]?{webOSVer:2,chipset:n.boardType.split("_")[0]}:i.length>=1&&"3"===i[0]?{webOSVer:3,chipset:n.boardType.split("_")[0]}:i.length>=1&&"4"===i[0]?{webOSVer:4,chipset:n.boardType.split("_")[0]}:{webOSVer:0,chipset:""},a=l.webOSVer,delete n.returnValue,t(l)},onFailure:function(n){e("getPlatformInfo: onFailure"),delete n.returnValue,l={webOSVer:0,chipset:""},t(l)}}):t(l)}function u(e){if("H15"==l.chipset)switch(e){case"ext://hdmi:1":return"HDMI1";case"ext://hdmi:2":return"HDMI2";case"ext://hdmi:3":case"ext://dvi:1":return"OPS/HDMI3/DVI";case"ext://dp:1":return"DISPLAYPORT";case"ext://rgb:1":return"RGB";case"ext://ops:1":return"OPS/HDMI3/DVI";case"HDMI1":return"ext://hdmi:1";case"HDMI2":return"ext://hdmi:2";case"HDMI3":return"ext://hdmi:3";case"DVI":return"ext://dvi:1";case"DISPLAYPORT":return"ext://dp:1";case"RGB":return"ext://rgb:1";case"OPS":return"ext://ops:1";case"OPS/HDMI3/DVI":return"ext://hdmi:3"}else switch(e){case"ext://hdmi:1":return"HDMI1";case"ext://hdmi:2":return"HDMI2";case"ext://hdmi:3":return"HDMI3";case"ext://dvi:1":return"DVI";case"ext://dp:1":return"DISPLAYPORT";case"ext://rgb:1":return"RGB";case"ext://ops:1":return"OPS";case"HDMI1":case"HDMI":return"ext://hdmi:1";case"HDMI2":return"ext://hdmi:2";case"HDMI3":return"ext://hdmi:3";case"DVI":return"ext://dvi:1";case"DISPLAYPORT":return"ext://dp:1";case"RGB":return"ext://rgb:1";case"OPS":return"ext://ops:1";case"OPS/HDMI3/DVI":return"ext://hdmi:3"}return null}var s,f;"object"==typeof window?(cordova.define("cordova/plugin/power",function(t,n,i){s=function(){},window.PalmSystem?(e("Window.PalmSystem Available"),f=t("cordova/plugin/webos/service")):f={Request:function(t,n){e(t+" invoked. But I am a dummy because PalmSystem is not available"),"function"==typeof n.onFailure&&n.onFailure({returnValue:!1,errorText:"PalmSystem Not Available. Cordova is not installed?"})}},i.exports=s}),s=cordova.require("cordova/plugin/power")):(s=function(e){f=e,f.Request=function(e,t){var n=e+"/"+t.method,i={};!0===t.hasOwnProperty("parameters")&&(i=t.parameters);var r={},o=function(e){console.log("res : "+JSON.stringify(e)),!0===e.payload.returnValue?(r=e.payload,t.onSuccess(r)):(r.returnValue=!1,r.errorCode=e.payload.errorCode,r.errorText=e.payload.errorText,t.onFailure(r))};f&&f.call(n,i,o)}},module.exports=s);var a=null,l={};return s.PowerCommand={SHUTDOWN:"powerOff",REBOOT:"reboot"},s.DisplayMode={DISPLAY_OFF:"Screen Off",DISPLAY_ON:"Active"},s.TimerWeek={MONDAY:1,TUESDAY:2,WEDNESDAY:4,THURSDAY:8,FRIDAY:16,SATURDAY:32,SUNDAY:64,EVERYDAY:127},s.DPMSignalType={CLOCK:"clock",CLOCK_WITH_DATA:"clockAndData"},s.PMMode={PowerOff:"powerOff",SustainAspectRatio:"sustainAspectRatio",ScreenOff:"screenOff",ScreenOffAlways:"screenOffAlways",ScreenOffBacklight:"screenOffBacklight"},s.prototype.getPowerStatus=function(n,i){e("getPowerStatus: "),r(function(r){4===r.webOSVer||r.webOSVer>4?f.Request("luna://com.webos.service.commercial.scapadapter/power/",{method:"getPowerStatus",parameters:{},onSuccess:function(t){e("getPowerStatus: On Success"),delete t.returnValue,"function"==typeof n&&n(t)},onFailure:function(n){e("getPowerStatus: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PGPS","Power.getPowerStatus returns failure."),i(n))}}):f.Request("luna://com.webos.service.tv.signage/",{method:"getPowerState",onSuccess:function(r){e("getPowerStatus: On Success");var o={};!0===r.returnValue&&(o.displayMode=r.state),f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["wolEnable"]},onSuccess:function(r){e("getPowerStatus: On Success 2"),!0===r.returnValue&&(o.wakeOnLan="1"===r.settings.wolEnable),f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"time",keys:["onTimerEnable","offTimerEnable"]},onSuccess:function(t){e("getPowerStatus: On Success 3"),!0===t.returnValue&&(o.allOnTimer="on"===t.settings.onTimerEnable,o.allOffTimer="on"===t.settings.offTimerEnable,"function"==typeof n&&n(o))},onFailure:function(n){e("getPowerStatus: On Failure 3"),delete n.returnValue,"function"==typeof i&&(t(n,"PGPS","Power.getPowerStatus returns failure."),i(n))}})},onFailure:function(n){e("getPowerStatus: On Failure 2"),delete n.returnValue,"function"==typeof i&&(t(n,"PGPS","Power.getPowerStatus returns failure."),i(n))}})},onFailure:function(n){e("getPowerStatus: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PGPS","Power.getPowerStatus returns failure."),i(n))}})}),e("Power.getPowerStatus Done")},s.prototype.enableAllOnTimer=function(n,i,o){e("enableAllOnTimer: "+JSON.stringify(o));var u=null;switch(o.allOnTimer){case!0:u="on";break;case!1:u="off";break;default:if("function"==typeof i){var s={};t(s,"PEAOT","Power.enableAllOnTimer returns failure. Invalid option value."),i(s)}return}r(function(r){4===r.webOSVer||r.webOSVer>4?f.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"set",parameters:{category:"time",settings:{onTimerEnable:u}},onSuccess:function(){!0===o.clearOnTimer?f.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"get",parameters:{category:"commercial",keys:["onOffTimeSchedule"]},onSuccess:function(r){if(!0===r.returnValue){var o=0,u={};u.onTime=[],u.offTime=[];var s={},a=null===r.settings.onOffTimeSchedule.offTime||void 0===r.settings.onOffTimeSchedule.offTime?0:r.settings.onOffTimeSchedule.offTime.length;for(o=0;o<a;o++)void 0!==r.settings.onOffTimeSchedule.offTime[o].day&&null!==r.settings.onOffTimeSchedule.offTime[o].day&&(s.day=r.settings.onOffTimeSchedule.offTime[o].day),void 0!==r.settings.onOffTimeSchedule.offTime[o].hour&&null!==r.settings.onOffTimeSchedule.offTime[o].hour&&(s.hour=r.settings.onOffTimeSchedule.offTime[o].hour),void 0!==r.settings.onOffTimeSchedule.offTime[o].minute&&null!==r.settings.onOffTimeSchedule.offTime[o].minute&&(s.minute=r.settings.onOffTimeSchedule.offTime[o].minute),u.offTime.push(s),s={};f.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"set",parameters:{category:"commercial",settings:{onOffTimeSchedule:u}},onSuccess:function(){e("enableAllOnTimer: On Success 2"),"function"==typeof n&&n()},onFailure:function(n){e("enableAllOnTimer: On Failure 2"),delete n.returnValue,"function"==typeof i&&(t(n,"PAOT","Power.enableAllOnTimer returns failure."),i(n))}})}else"function"==typeof n&&(e("enableAllOnTimer: On Success"),n())},onFailure:function(n){delete n.returnValue,"function"==typeof i&&(e("enableAllOnTimer: On Failure"),t(n,"PEAOT","Power.enableAllOnTimer returns failure."),i(n))}}):"function"==typeof n&&(e("enableAllOnTimer: On Success"),n())},onFailure:function(n){delete n.returnValue,"function"==typeof i&&(e("enableAllOnTimer: On Failure"),t(n,"PEAOT","Power.enableAllOnTimer returns failure."),i(n))}}):f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"time",settings:{onTimerEnable:u}},onSuccess:function(){if(!0===o.clearOnTimer){var r=["0","0","0","0","0","0","0"],u=["0","0","0","0","0","0","0"],s=["0","0","0","0","0","0","0"],a=["0","0","0","0","0","0","0"],l=[];f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{multiOnTimerHour:r,multiOnTimerMinute:u,multiOnTimerWeekday:s,multiOnTimerSource:a,onTimerCount:0,onTimerSchedule:l}},onSuccess:function(){e("enableAllOnTimer: On Success 2"),"function"==typeof n&&n()},onFailure:function(n){e("enableAllOnTimer: On Failure 2"),delete n.returnValue,"function"==typeof i&&(t(n,"PEAOT","Power.enableAllOnTimer returns failure. / clearOnTimer"),i(n))}})}else"function"==typeof n&&(e("enableAllOnTimer: On Success"),n())},onFailure:function(n){delete n.returnValue,"function"==typeof i&&(e("enableAllOnTimer: On Failure"),t(n,"PEAOT","Power.enableAllOnTimer returns failure."),i(n))}})}),e("Power.enableAllOnTimer Done")},s.prototype.enableAllOffTimer=function(n,i,o){e("enableAllOffTimer: "+JSON.stringify(o));var u=null;switch(o.allOffTimer){case!0:u="on";break;case!1:u="off";break;default:if("function"==typeof i){var s={};t(s,"PEAOT","Power.enableAllOffTimer returns failure. Invalid option value."),i(s)}return}r(function(r){4===r.webOSVer||r.webOSVer>4?f.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"set",parameters:{category:"time",settings:{offTimerEnable:u}},onSuccess:function(){!0===o.clearOffTimer?f.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"get",parameters:{category:"commercial",keys:["onOffTimeSchedule"]},onSuccess:function(r){if(!0===r.returnValue){var o=0,u={};u.onTime=[],u.offTime=[];var s={},a=null===r.settings.onOffTimeSchedule.onTime||void 0===r.settings.onOffTimeSchedule.onTime?0:r.settings.onOffTimeSchedule.onTime.length;for(o=0;o<a;o++)void 0!==r.settings.onOffTimeSchedule.onTime[o].day&&null!==r.settings.onOffTimeSchedule.onTime[o].day&&(s.day=r.settings.onOffTimeSchedule.onTime[o].day),void 0!==r.settings.onOffTimeSchedule.onTime[o].hour&&null!==r.settings.onOffTimeSchedule.onTime[o].hour&&(s.hour=r.settings.onOffTimeSchedule.onTime[o].hour),void 0!==r.settings.onOffTimeSchedule.onTime[o].minute&&null!==r.settings.onOffTimeSchedule.onTime[o].minute&&(s.minute=r.settings.onOffTimeSchedule.onTime[o].minute),u.onTime.push(s),s={};f.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"set",parameters:{category:"commercial",settings:{onOffTimeSchedule:u}},onSuccess:function(){e("enableAllOffTimer: On Success 2"),"function"==typeof n&&n()},onFailure:function(n){e("enableAllOffTimer: On Failure 2"),delete n.returnValue,"function"==typeof i&&(t(n,"PAOT","Power.enableAllOffTimer returns failure."),i(n))}})}else"function"==typeof n&&(e("enableAllOffTimer: On Success"),n())},onFailure:function(n){delete n.returnValue,"function"==typeof i&&(e("enableAllOffTimer: On Failure"),t(n,"PEAOT","Power.enableAllOffTimer returns failure."),i(n))}}):"function"==typeof n&&(e("enableAllOffTimer: On Success"),n())},onFailure:function(n){delete n.returnValue,"function"==typeof i&&(e("enableAllOffTimer: On Failure"),t(n,"PEAOT","Power.enableAllOffTimer returns failure."),i(n))}}):f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"time",settings:{offTimerEnable:u}},onSuccess:function(){if(!0===o.clearOffTimer){var r=["0","0","0","0","0","0","0"],u=["0","0","0","0","0","0","0"],s=["0","0","0","0","0","0","0"],a=[];f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{multiOffTimerHour:r,multiOffTimerMinute:u,multiOffTimerWeekday:s,offTimerCount:0,offTimerSchedule:a}},onSuccess:function(){e("enableAllOffTimer: On Success 2"),"function"==typeof n&&n()},onFailure:function(n){e("enableAllOffTimer: On Failure 2"),delete n.returnValue,"function"==typeof i&&(t(n,"PEAOT","Power.enableAllOffTimer returns failure. / clearOffTimer"),i(n))}})}else"function"==typeof n&&(e("enableAllOffTimer: On Success"),n())},onFailure:function(n){delete n.returnValue,"function"==typeof i&&(e("enableAllOffTimer: On Failure"),t(n,"PEAOT","Power.enableAllOffTimer returns failure."),i(n))}})}),e("Power.enableAllOffTimer Done")},s.prototype.enableWakeOnLan=function(n,i,r){e("enableWakeOnLan: "+JSON.stringify(r));var o=null;switch(r.wakeOnLan){case!0:o="1";break;case!1:o="0";break;default:if("function"==typeof i){var u={};t(u,"PSWOL","Power.enableWakeOnLan returns failure. Invalid option value."),i(u)}return}f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{wolEnable:o}},onSuccess:function(){"function"==typeof n&&(e("enableWakeOnLan: On Success"),n())},onFailure:function(n){delete n.returnValue,"function"==typeof i&&(e("enableWakeOnLan: On Failure"),t(n,"PSWOL","Power.enableWakeOnLan returns failure."),i(n))}}),e("Power.enableWakeOnLan Done")},s.prototype.addOnTimer=function(n,i,o){e("addOnTimer: "+JSON.stringify(o)),r(function(r){if(4===r.webOSVer||r.webOSVer>4){if(void 0===o.hour||isNaN(o.hour)||"number"!=typeof o.hour||o.hour<0||o.hour>23||void 0===o.minute||isNaN(o.minute)||"number"!=typeof o.minute||o.minute<0||o.minute>59||void 0===o.week||isNaN(o.week)||"number"!=typeof o.week||o.week<=0||o.week>127){if("function"==typeof i){var u={};t(u,"PAOT","Power.addOnTimer returns failure. invalid parameters or out of range."),i(u)}return}f.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"get",parameters:{category:"commercial",keys:["onOffTimeSchedule"]},onSuccess:function(r){if(!0===r.returnValue){var u=0,s={};s.onTime=[],s.offTime=[];for(var a=[],l={},m=1;0!==o.week;){if(1&o.week)switch(console.log("AddonTimer - options.week - "+o.week),m){case 1:a.push("mon");break;case 2:a.push("tue");break;case 4:a.push("wed");break;case 8:a.push("thu");break;case 16:a.push("fri");break;case 32:a.push("sat");break;case 64:a.push("sun")}if(o.week=o.week>>>1,m<<=1,0===o.week)break}l.day=a,l.hour=o.hour,l.minute=o.minute,s.onTime.push(l),l={};var c=null===r.settings.onOffTimeSchedule.onTime||void 0===r.settings.onOffTimeSchedule.onTime?0:r.settings.onOffTimeSchedule.onTime.length;for(u=0;u<c;u++)void 0!==r.settings.onOffTimeSchedule.onTime[u].day&&null!==r.settings.onOffTimeSchedule.onTime[u].day&&(l.day=r.settings.onOffTimeSchedule.onTime[u].day),void 0!==r.settings.onOffTimeSchedule.onTime[u].hour&&null!==r.settings.onOffTimeSchedule.onTime[u].hour&&(l.hour=r.settings.onOffTimeSchedule.onTime[u].hour),void 0!==r.settings.onOffTimeSchedule.onTime[u].minute&&null!==r.settings.onOffTimeSchedule.onTime[u].minute&&(l.minute=r.settings.onOffTimeSchedule.onTime[u].minute),s.onTime.push(l),l={};var d=null===r.settings.onOffTimeSchedule.offTime||void 0===r.settings.onOffTimeSchedule.offTime?0:r.settings.onOffTimeSchedule.offTime.length;for(u=0;u<d;u++)void 0!==r.settings.onOffTimeSchedule.offTime[u].day&&null!==r.settings.onOffTimeSchedule.offTime[u].day&&(l.day=r.settings.onOffTimeSchedule.offTime[u].day),void 0!==r.settings.onOffTimeSchedule.offTime[u].hour&&null!==r.settings.onOffTimeSchedule.offTime[u].hour&&(l.hour=r.settings.onOffTimeSchedule.offTime[u].hour),void 0!==r.settings.onOffTimeSchedule.offTime[u].minute&&null!==r.settings.onOffTimeSchedule.offTime[u].minute&&(l.minute=r.settings.onOffTimeSchedule.offTime[u].minute),s.offTime.push(l),l={};f.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"set",parameters:{category:"commercial",settings:{onOffTimeSchedule:s}},onSuccess:function(){e("addOnTimer: On Success 2"),"function"==typeof n&&n()},onFailure:function(n){e("addOnTimer: On Failure 2"),delete n.returnValue,"function"==typeof i&&(t(n,"PAOT","Power.addOnTimer returns failure."),i(n))}})}},onFailure:function(n){e("addOnTimer: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PAOT","Power.addOnTimer returns failure."),i(n))}})}else{if(void 0===o.hour||isNaN(o.hour)||"number"!=typeof o.hour||o.hour<0||o.hour>23||void 0===o.minute||isNaN(o.minute)||"number"!=typeof o.minute||o.minute<0||o.minute>59||void 0===o.week||isNaN(o.week)||"number"!=typeof o.week||o.week<0||o.week>127||void 0===o.inputSource||"string"!=typeof o.inputSource||0!==o.inputSource.indexOf("ext://")){if("function"==typeof i){var u={};t(u,"PAOT","Power.addOnTimer returns failure. invalid parameters or out of range."),i(u)}return}f.Request("luna://com.webos.service.eim/",{method:"getAllInputStatus",onSuccess:function(u){if(e("getInputSourceStatus: On Success"),!0===u.returnValue){for(var s=!1,a=0;a<u.totalCount;a++){var l=u.devices[a].deviceName.toLowerCase(),m=l,c=o.inputSource.substring(6).split(":"),d="1";if(!1===isNaN(l.substring(l.length-1,l.length))&&(l=l.substring(0,l.length-1),d=u.devices[a].id.split("_")[1]),"DISPLAYPORT"===l.toUpperCase()&&(l="DP"),l.toUpperCase().indexOf(c[0].toUpperCase())>=0&&d===c[1]){s=!0;break}}if(!1===s)return e("addOnTimer: On Failure"),delete u.returnValue,void("function"==typeof i&&(t(u,"PAOT","Power.addOnTimer returns failure."),i(u)));f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["multiOnTimerHour","multiOnTimerMinute","multiOnTimerWeekday","multiOnTimerSource","onTimerSchedule","onTimerCount"]},onSuccess:function(u){if(!0===u.returnValue){e("version : "+r.webOSVer),"string"==typeof u.settings.multiOnTimerHour&&(u.settings.multiOnTimerHour=JSON.parse(u.settings.multiOnTimerHour)),"string"==typeof u.settings.multiOnTimerMinute&&(u.settings.multiOnTimerMinute=JSON.parse(u.settings.multiOnTimerMinute)),"string"==typeof u.settings.multiOnTimerWeekday&&(u.settings.multiOnTimerWeekday=JSON.parse(u.settings.multiOnTimerWeekday)),"string"==typeof u.settings.multiOnTimerSource&&(u.settings.multiOnTimerSource=JSON.parse(u.settings.multiOnTimerSource)),"string"==typeof u.settings.onTimerSchedule&&(u.settings.onTimerSchedule=JSON.parse(u.settings.onTimerSchedule));var s=null===u.settings.onTimerSchedule||void 0===u.settings.onTimerSchedule?0:u.settings.onTimerSchedule.length;if(u.settings.multiOnTimerHour.length<=s)return void("function"==typeof i&&(t(u,"PSOT","Power.addOnTimer returns failure. No space to add timer."),i(u)));3===r.webOSVer&&(o.week>=64?o.week=1+2*(o.week-64):o.week=2*o.week),u.settings.multiOnTimerHour[s]=o.hour,u.settings.multiOnTimerMinute[s]=o.minute,u.settings.multiOnTimerWeekday[s]=o.week,u.settings.multiOnTimerSource[s]=m.toUpperCase();var a=360;u.settings.onTimerSchedule[s]={_id:""+a++,hour:o.hour,input:m.toUpperCase(),minute:o.minute,weekday:o.week},f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{multiOnTimerHour:u.settings.multiOnTimerHour,multiOnTimerMinute:u.settings.multiOnTimerMinute,multiOnTimerWeekday:u.settings.multiOnTimerWeekday,multiOnTimerSource:u.settings.multiOnTimerSource,onTimerCount:s+1,onTimerSchedule:u.settings.onTimerSchedule}},onSuccess:function(){e("addOnTimer: On Success 2"),"function"==typeof n&&n()},onFailure:function(n){e("addOnTimer: On Failure 2"),delete n.returnValue,"function"==typeof i&&(t(n,"PAOT","Power.addOnTimer returns failure."),i(n))}})}},onFailure:function(n){e("addOnTimer: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PAOT","Power.addOnTimer returns failure."),i(n))}})}},onFailure:function(n){e("getInputSourceStatus: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PAOT","Power.addOnTimer returns failure on gathering input list."),i(n))}})}}),e("Power.addOnTimer Done")},s.prototype.deleteOnTimer=function(i,o,s){e("deleteOnTimer: "+JSON.stringify(s)),r(function(a){if(4===a.webOSVer||a.webOSVer>4){if(void 0===s.hour||isNaN(s.hour)||"number"!=typeof s.hour||s.hour<0||s.hour>23||void 0===s.minute||isNaN(s.minute)||"number"!=typeof s.minute||s.minute<0||s.minute>59||void 0===s.week||isNaN(s.week)||"number"!=typeof s.week||s.week<0||s.week>127){if("function"==typeof o){var l={};t(l,"PAOT","Power.deleteOnTimer returns failure. invalid parameters or out of range."),o(l)}return}f.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"get",parameters:{category:"commercial",keys:["onOffTimeSchedule"]},onSuccess:function(r){if(!0===r.returnValue){var u=0,a={};a.onTime=[],a.offTime=[];for(var l=[],m={},c={},d=1;0!==s.week;){if(1&s.week)switch(d){case 1:l.push("mon");break;case 2:l.push("tue");break;case 4:l.push("wed");break;case 8:l.push("thu");break;case 16:l.push("fri");break;case 32:l.push("sat");break;case 64:l.push("sun")}if(s.week=s.week>>>1,d<<=1,0===s.week)break}d=0,m.day=l,m.hour=s.hour,m.minute=s.minute;var T=null===r.settings.onOffTimeSchedule.onTime||void 0===r.settings.onOffTimeSchedule.onTime?0:r.settings.onOffTimeSchedule.onTime.length,O=!1;for(u=0;u<T;u++)void 0!==r.settings.onOffTimeSchedule.onTime[u].day&&null!==r.settings.onOffTimeSchedule.onTime[u].day&&(n(r.settings.onOffTimeSchedule.onTime[u].day,m.day)?d++:c.day=r.settings.onOffTimeSchedule.onTime[u].day),void 0!==r.settings.onOffTimeSchedule.onTime[u].hour&&null!==r.settings.onOffTimeSchedule.onTime[u].hour&&(r.settings.onOffTimeSchedule.onTime[u].hour===m.hour?d++:c.hour=r.settings.onOffTimeSchedule.onTime[u].hour),void 0!==r.settings.onOffTimeSchedule.onTime[u].minute&&null!==r.settings.onOffTimeSchedule.onTime[u].minute&&(r.settings.onOffTimeSchedule.onTime[u].minute===m.minute?d++:c.minute=r.settings.onOffTimeSchedule.onTime[u].minute),3!==d?a.onTime.push(c):O=!0,d=0,c={};var g=null===r.settings.onOffTimeSchedule.offTime||void 0===r.settings.onOffTimeSchedule.offTime?0:r.settings.onOffTimeSchedule.offTime.length;for(u=0;u<g;u++)void 0!==r.settings.onOffTimeSchedule.offTime[u].day&&null!==r.settings.onOffTimeSchedule.offTime[u].day&&(c.day=r.settings.onOffTimeSchedule.offTime[u].day),void 0!==r.settings.onOffTimeSchedule.offTime[u].hour&&null!==r.settings.onOffTimeSchedule.offTime[u].hour&&(c.hour=r.settings.onOffTimeSchedule.offTime[u].hour),void 0!==r.settings.onOffTimeSchedule.offTime[u].minute&&null!==r.settings.onOffTimeSchedule.offTime[u].minute&&(c.minute=r.settings.onOffTimeSchedule.offTime[u].minute),a.offTime.push(c),c={};if(O)f.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"set",parameters:{category:"commercial",settings:{onOffTimeSchedule:a}},onSuccess:function(){e("deleteOnTimer: On Success 2"),"function"==typeof i&&i()},onFailure:function(n){e("deleteOnTimer: On Failure 2"),delete n.returnValue,"function"==typeof o&&(t(n,"PAOT","Power.deleteOnTimer returns failure."),o(n))}});else{var r={};t(r,"PAOT","Power.deleteOnTimer returns failure. / No matched found"),o(r)}}},onFailure:function(n){e("deleteOnTimer: On Failure"),delete n.returnValue,"function"==typeof o&&(t(n,"PAOT","Power.deleteOnTimer returns failure."),o(n))}})}else{if(void 0===s.hour||isNaN(s.hour)||"number"!=typeof s.hour||s.hour<0||s.hour>23||void 0===s.minute||isNaN(s.minute)||"number"!=typeof s.minute||s.minute<0||s.minute>59||void 0===s.week||isNaN(s.week)||"number"!=typeof s.week||s.week<0||s.week>127||void 0===s.inputSource||"string"!=typeof s.inputSource||0!==s.inputSource.indexOf("ext://")){if("function"==typeof o){var l={};t(l,"PDOT","Power.deleteOnTimer returns failure. invalid parameters or out of range."),o(l)}return}f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["multiOnTimerHour","multiOnTimerMinute","multiOnTimerWeekday","multiOnTimerSource","onTimerSchedule","onTimerCount"]},onSuccess:function(n){!0===n.returnValue&&r(function(r){f.Request("luna://com.webos.service.eim/",{method:"getAllInputStatus",onSuccess:function(a){if(e("getInputSourceStatus: On Success"),!0===n.returnValue){e("version : "+r.webOSVer),"string"==typeof n.settings.multiOnTimerHour&&(n.settings.multiOnTimerHour=JSON.parse(n.settings.multiOnTimerHour)),"string"==typeof n.settings.multiOnTimerMinute&&(n.settings.multiOnTimerMinute=JSON.parse(n.settings.multiOnTimerMinute)),"string"==typeof n.settings.multiOnTimerWeekday&&(n.settings.multiOnTimerWeekday=JSON.parse(n.settings.multiOnTimerWeekday)),"string"==typeof n.settings.multiOnTimerSource&&(n.settings.multiOnTimerSource=JSON.parse(n.settings.multiOnTimerSource)),"string"==typeof n.settings.onTimerSchedule&&(n.settings.onTimerSchedule=JSON.parse(n.settings.onTimerSchedule));for(var l=0,m=null===n.settings.onTimerSchedule||void 0===n.settings.onTimerSchedule?0:n.settings.onTimerSchedule.length,c=["0","0","0","0","0","0","0"],d=["0","0","0","0","0","0","0"],T=["0","0","0","0","0","0","0"],O=["0","0","0","0","0","0","0"],g=[],h=u(s.inputSource),S=0;S<a.totalCount;S++){var p=a.devices[S].deviceName,y=p,w=s.inputSource.substring(6).split(":"),P="1";if(!1===isNaN(p.substring(p.length-1,p.length))&&(p=p.substring(0,p.length-1),P=a.devices[S].id.split("_")[1]),"DISPLAYPORT"===p.toUpperCase()&&(p="DP"),p.toUpperCase().indexOf(w[0].toUpperCase())>=0&&P===w[1]){h=y;break}}var v=!1;3===r.webOSVer&&(s.week>=64?s.week=1+2*(s.week-64):s.week=2*s.week);for(var S=0;S<m;S++)e("deleteOnTimer: "+h),null!==n.settings.onTimerSchedule[S]&&(e("options.week : "+s.week+" result.settings.onTimerSchedule["+S+"].weekday : "+n.settings.onTimerSchedule[S].weekday),!1===v&&s.hour===n.settings.onTimerSchedule[S].hour&&s.minute===n.settings.onTimerSchedule[S].minute&&s.week==n.settings.onTimerSchedule[S].weekday&&n.settings.onTimerSchedule[S].input.toUpperCase()===h.toUpperCase()?(e("deleteOnTimer: index "+S),v=!0):(c[l]=n.settings.multiOnTimerHour[S],d[l]=n.settings.multiOnTimerMinute[S],T[l]=n.settings.multiOnTimerWeekday[S],O[l]=n.settings.multiOnTimerSource[S],g[l]=n.settings.onTimerSchedule[S],l++));if(!0===v&&m--,0===m&&(g=[]),n.settings.onTimerSchedule.length===m)return void("function"==typeof o&&(t(n,"PDOT","Power.deleteOnTimer returns failure. There is no 'on timer' matched in the list."),o(n)));f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{multiOnTimerHour:c,multiOnTimerMinute:d,multiOnTimerWeekday:T,multiOnTimerSource:O,onTimerCount:m,onTimerSchedule:g}},onSuccess:function(){e("deleteOnTimer: On Success 2"),"function"==typeof i&&i()},onFailure:function(n){e("deleteOnTimer: On Failure 2"),delete n.returnValue,"function"==typeof o&&(t(n,"PDOT","Power.deleteOnTimer returns failure."),o(n))}})}},onFailure:function(n){e("getInputSourceStatus: On Failure"),delete n.returnValue,"function"==typeof o&&(t(n,"PDOT","Power.deleteOnTimer returns failure"),o(n))}})})},onFailure:function(n){e("deleteOnTimer: On Failure"),delete n.returnValue,"function"==typeof o&&(t(n,"PDOT","Power.deleteOnTimer returns failure."),o(n))}})}}),e("Power.deleteOnTimer Done")},s.prototype.addOffTimer=function(n,i,o){if(e("addOffTimer: "+JSON.stringify(o)),void 0===o.hour||isNaN(o.hour)||"number"!=typeof o.hour||o.hour<0||o.hour>23||void 0===o.minute||isNaN(o.minute)||"number"!=typeof o.minute||o.minute<0||o.minute>59||void 0===o.week||isNaN(o.week)||"number"!=typeof o.week||o.week<=0||o.week>127){if("function"==typeof i){var u={};t(u,"PAOT","Power.addOffTimer returns failure. Invalid parameter."),i(u)}}else r(function(u){4===u.webOSVer||u.webOSVer>4?f.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"get",parameters:{category:"commercial",keys:["onOffTimeSchedule"]},onSuccess:function(r){if(!0===r.returnValue){var u=0,s={};s.onTime=[],s.offTime=[];for(var a=[],l={},m=1;0!==o.week;){if(1&o.week)switch(m){case 1:a.push("mon");break;case 2:a.push("tue");break;case 4:a.push("wed");break;case 8:a.push("thu");break;case 16:a.push("fri");break;case 32:a.push("sat");break;case 64:a.push("sun")}if(o.week=o.week>>>1,m<<=1,0===o.week)break}l.day=a,l.hour=o.hour,l.minute=o.minute,s.offTime.push(l),l={};var c=null===r.settings.onOffTimeSchedule.onTime||void 0===r.settings.onOffTimeSchedule.onTime?0:r.settings.onOffTimeSchedule.onTime.length;for(u=0;u<c;u++)void 0!==r.settings.onOffTimeSchedule.onTime[u].day&&null!==r.settings.onOffTimeSchedule.onTime[u].day&&(l.day=r.settings.onOffTimeSchedule.onTime[u].day),void 0!==r.settings.onOffTimeSchedule.onTime[u].hour&&null!==r.settings.onOffTimeSchedule.onTime[u].hour&&(l.hour=r.settings.onOffTimeSchedule.onTime[u].hour),void 0!==r.settings.onOffTimeSchedule.onTime[u].minute&&null!==r.settings.onOffTimeSchedule.onTime[u].minute&&(l.minute=r.settings.onOffTimeSchedule.onTime[u].minute),s.onTime.push(l),l={};var d=null===r.settings.onOffTimeSchedule.offTime||void 0===r.settings.onOffTimeSchedule.offTime?0:r.settings.onOffTimeSchedule.offTime.length;for(u=0;u<d;u++)void 0!==r.settings.onOffTimeSchedule.offTime[u].day&&null!==r.settings.onOffTimeSchedule.offTime[u].day&&(l.day=r.settings.onOffTimeSchedule.offTime[u].day),void 0!==r.settings.onOffTimeSchedule.offTime[u].hour&&null!==r.settings.onOffTimeSchedule.offTime[u].hour&&(l.hour=r.settings.onOffTimeSchedule.offTime[u].hour),void 0!==r.settings.onOffTimeSchedule.offTime[u].minute&&null!==r.settings.onOffTimeSchedule.offTime[u].minute&&(l.minute=r.settings.onOffTimeSchedule.offTime[u].minute),s.offTime.push(l),l={};f.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"set",parameters:{category:"commercial",settings:{onOffTimeSchedule:s}},onSuccess:function(){e("addOffTimer: On Success 2"),"function"==typeof n&&n()},onFailure:function(n){e("addOffTimer: On Failure 2"),delete n.returnValue,"function"==typeof i&&(t(n,"PAOT","Power.addOffTimer returns failure."),i(n))}})}},onFailure:function(n){e("addOffTimer: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PAOT","Power.addOffTimer returns failure."),i(n))}}):f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["multiOffTimerHour","multiOffTimerMinute","multiOffTimerWeekday","offTimerSchedule","offTimerCount"]},onSuccess:function(u){if(!0===u.returnValue){"string"==typeof u.settings.multiOffTimerHour&&(u.settings.multiOffTimerHour=JSON.parse(u.settings.multiOffTimerHour)),"string"==typeof u.settings.multiOffTimerMinute&&(u.settings.multiOffTimerMinute=JSON.parse(u.settings.multiOffTimerMinute)),"string"==typeof u.settings.multiOffTimerWeekday&&(u.settings.multiOffTimerWeekday=JSON.parse(u.settings.multiOffTimerWeekday)),"string"==typeof u.settings.offTimerSchedule&&(u.settings.offTimerSchedule=JSON.parse(u.settings.offTimerSchedule));var s=null===u.settings.offTimerSchedule||void 0===u.settings.offTimerSchedule?0:u.settings.offTimerSchedule.length;if(u.settings.multiOffTimerHour.length<=s)return void("function"==typeof i&&(t(u,"PAOT","Power.addOffTimer returns failure. No space to add timer."),i(u)));r(function(r){e("version : "+r.webOSVer),3===r.webOSVer&&(o.week>=64?o.week=1+2*(o.week-64):o.week=2*o.week),u.settings.multiOffTimerHour[s]=o.hour,u.settings.multiOffTimerMinute[s]=o.minute,u.settings.multiOffTimerWeekday[s]=o.week,e("add hour: "+o.hour+", min : "+o.minute+", week : "+o.week);var a=360;u.settings.offTimerSchedule[s]={_id:""+a++,hour:o.hour,minute:o.minute,weekday:o.week},f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{multiOffTimerHour:u.settings.multiOffTimerHour,multiOffTimerMinute:u.settings.multiOffTimerMinute,multiOffTimerWeekday:u.settings.multiOffTimerWeekday,offTimerCount:s+1,offTimerSchedule:u.settings.offTimerSchedule}},onSuccess:function(){e("addOffTimer: On Success 2"),"function"==typeof n&&n()},onFailure:function(n){e("addOffTimer: On Failure 2"),delete n.returnValue,"function"==typeof i&&(t(n,"PAOT","Power.addOffTimer returns failure."),i(n))}})})}},onFailure:function(n){e("addOffTimer: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PAOT","Power.addOffTimer returns failure."),i(n))}})}),e("Power.addOffTimer Done")},s.prototype.deleteOffTimer=function(i,o,u){e("deleteOffTimer: "+JSON.stringify(u)),r(function(s){if(4===s.webOSVer||s.webOSVer>4){
if(void 0===u.hour||isNaN(u.hour)||"number"!=typeof u.hour||u.hour<0||u.hour>23||void 0===u.minute||isNaN(u.minute)||"number"!=typeof u.minute||u.minute<0||u.minute>59||void 0===u.week||isNaN(u.week)||"number"!=typeof u.week||u.week<0||u.week>127){if("function"==typeof o){var a={};t(a,"PAOT","Power.deleteOffTimer returns failure. invalid parameters or out of range."),o(a)}return}f.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"get",parameters:{category:"commercial",keys:["onOffTimeSchedule"]},onSuccess:function(r){if(!0===r.returnValue){var s=0,a={};a.onTime=[],a.offTime=[];for(var l=[],m={},c={},d=1;0!==u.week;){if(1&u.week)switch(d){case 1:l.push("mon");break;case 2:l.push("tue");break;case 4:l.push("wed");break;case 8:l.push("thu");break;case 16:l.push("fri");break;case 32:l.push("sat");break;case 64:l.push("sun")}if(u.week=u.week>>>1,d<<=1,0===u.week)break}d=0,m.day=l,m.hour=u.hour,m.minute=u.minute;var T=null===r.settings.onOffTimeSchedule.onTime||void 0===r.settings.onOffTimeSchedule.onTime?0:r.settings.onOffTimeSchedule.onTime.length,O=!1;for(s=0;s<T;s++)void 0!==r.settings.onOffTimeSchedule.onTime[s].day&&null!==r.settings.onOffTimeSchedule.onTime[s].day&&(c.day=r.settings.onOffTimeSchedule.onTime[s].day),void 0!==r.settings.onOffTimeSchedule.onTime[s].hour&&null!==r.settings.onOffTimeSchedule.onTime[s].hour&&(c.hour=r.settings.onOffTimeSchedule.onTime[s].hour),void 0!==r.settings.onOffTimeSchedule.onTime[s].minute&&null!==r.settings.onOffTimeSchedule.onTime[s].minute&&(c.minute=r.settings.onOffTimeSchedule.onTime[s].minute),a.onTime.push(c),c={};var g=null===r.settings.onOffTimeSchedule.offTime||void 0===r.settings.onOffTimeSchedule.offTime?0:r.settings.onOffTimeSchedule.offTime.length;for(s=0;s<g;s++)void 0!==r.settings.onOffTimeSchedule.offTime[s].day&&null!==r.settings.onOffTimeSchedule.offTime[s].day&&(n(r.settings.onOffTimeSchedule.offTime[s].day,m.day)?d++:c.day=r.settings.onOffTimeSchedule.offTime[s].day),void 0!==r.settings.onOffTimeSchedule.offTime[s].hour&&null!==r.settings.onOffTimeSchedule.offTime[s].hour&&(r.settings.onOffTimeSchedule.offTime[s].hour===m.hour?d++:c.hour=r.settings.onOffTimeSchedule.offTime[s].hour),void 0!==r.settings.onOffTimeSchedule.offTime[s].minute&&null!==r.settings.onOffTimeSchedule.offTime[s].minute&&(r.settings.onOffTimeSchedule.offTime[s].minute===m.minute?d++:c.minute=r.settings.onOffTimeSchedule.offTime[s].minute),3!==d?a.offTime.push(c):O=!0,d=0,c={};if(O)f.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"set",parameters:{category:"commercial",settings:{onOffTimeSchedule:a}},onSuccess:function(){e("deleteOffTimer: On Success 2"),"function"==typeof i&&i()},onFailure:function(n){e("deleteOffTimer: On Failure 2"),delete n.returnValue,"function"==typeof o&&(t(n,"PAOT","Power.deleteOffTimer returns failure."),o(n))}});else{var r={};t(r,"PAOT","Power.deleteOffTimer returns failure. / No matched found."),o(r)}}},onFailure:function(n){e("deleteOffTimer: On Failure"),delete n.returnValue,"function"==typeof o&&(t(n,"PAOT","Power.deleteOffTimer returns failure."),o(n))}})}else{if(void 0===u.hour||isNaN(u.hour)||"number"!=typeof u.hour||u.hour<0||u.hour>23||void 0===u.minute||isNaN(u.minute)||"number"!=typeof u.minute||u.minute<0||u.minute>59||void 0===u.week||isNaN(u.week)||"number"!=typeof u.week||u.week<0||u.week>127){if("function"==typeof o){var a={};t(a,"PDOT","Power.deleteOffTimer returns failure. invalid parameters or out of range."),o(a)}return}f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["multiOffTimerHour","multiOffTimerMinute","multiOffTimerWeekday","offTimerSchedule","offTimerCount"]},onSuccess:function(n){if(!0===n.returnValue){"string"==typeof n.settings.multiOffTimerHour&&(n.settings.multiOffTimerHour=JSON.parse(n.settings.multiOffTimerHour)),"string"==typeof n.settings.multiOffTimerMinute&&(n.settings.multiOffTimerMinute=JSON.parse(n.settings.multiOffTimerMinute)),"string"==typeof n.settings.multiOffTimerWeekday&&(n.settings.multiOffTimerWeekday=JSON.parse(n.settings.multiOffTimerWeekday)),"string"==typeof n.settings.offTimerSchedule&&(n.settings.offTimerSchedule=JSON.parse(n.settings.offTimerSchedule));var s=0,a=null===n.settings.offTimerSchedule||void 0===n.settings.offTimerSchedule?0:n.settings.offTimerSchedule.length,l=["0","0","0","0","0","0","0"],m=["0","0","0","0","0","0","0"],c=["0","0","0","0","0","0","0"],d=[],T=!1;r(function(t){e("version : "+t.webOSVer),3===t.webOSVer&&(u.week>=64?u.week=1+2*(u.week-64):u.week=2*u.week)});for(var O=0;O<a;O++)null!==n.settings.offTimerSchedule[O]&&(e("options.week : "+u.week+" result.settings.offTimerSchedule["+O+"].weekday : "+n.settings.offTimerSchedule[O].weekday),!1===T&&u.hour===n.settings.offTimerSchedule[O].hour&&u.minute===n.settings.offTimerSchedule[O].minute&&u.week===n.settings.offTimerSchedule[O].weekday?T=!0:(l[s]=n.settings.multiOffTimerHour[O],m[s]=n.settings.multiOffTimerMinute[O],c[s]=n.settings.multiOffTimerWeekday[O],d[s]=n.settings.offTimerSchedule[O],s++));if(!0===T&&a--,0===a&&(d=[]),n.settings.offTimerSchedule.length===a)return void("function"==typeof o&&(t(n,"PDOT","Power.deleteOffTimer returns failure. There is no 'off timer' matched in the list."),o(n)));f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{multiOffTimerHour:l,multiOffTimerMinute:m,multiOffTimerWeekday:c,offTimerCount:a,offTimerSchedule:d}},onSuccess:function(){e("deleteOffTimer: On Success 2"),"function"==typeof i&&i()},onFailure:function(n){e("deleteOffTimer: On Failure 2"),delete n.returnValue,"function"==typeof o&&(t(n,"PDOT","Power.deleteOffTimer returns failure."),o(n))}})}},onFailure:function(n){e("deleteOffTimer: On Failure"),delete n.returnValue,"function"==typeof o&&(t(n,"PDOT","Power.deleteOffTimer returns failure."),o(n))}})}}),e("Power.deleteOffTimer Done")},s.prototype.getOnTimerList=function(n,i){e("getOnTimerList: "),r(function(o){4===o.webOSVer||o.webOSVer>4?f.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"get",parameters:{category:"commercial",keys:["onOffTimeSchedule"]},onSuccess:function(e){if(!0===e.returnValue){for(var t={},i=new Array(null===e.settings.onOffTimeSchedule.onTime||void 0===e.settings.onOffTimeSchedule.onTime?0:e.settings.onOffTimeSchedule.onTime.length),r=0,o=0;o<i.length;o++,r++)if(null!==e.settings.onOffTimeSchedule.onTime[o]&&void 0!==e.settings.onOffTimeSchedule.onTime[o]){i[r]={hour:0,minute:0,week:0};for(var u=e.settings.onOffTimeSchedule.onTime[o].day,s=0,f=0;f<u.length;f++)"mon"===u[f]&&(s+=1),"tue"===u[f]&&(s+=2),"wed"===u[f]&&(s+=4),"thu"===u[f]&&(s+=8),"fri"===u[f]&&(s+=16),"sat"===u[f]&&(s+=32),"sun"===u[f]&&(s+=64);i[r].hour=e.settings.onOffTimeSchedule.onTime[o].hour,i[r].minute=e.settings.onOffTimeSchedule.onTime[o].minute,i[r].week=s}t.timerList=i,"function"==typeof n&&n(t)}},onFailure:function(n){e("getOnTimerList: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PGOTL","Power.getOnTimerList returns failure."),i(n))}}):f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["onTimerSchedule"]},onSuccess:function(t){!0===t.returnValue&&r(function(i){e("version : "+i.webOSVer);var r={};"string"==typeof t.settings.onTimerSchedule&&(t.settings.onTimerSchedule=JSON.parse(t.settings.onTimerSchedule));for(var o=new Array(null===t.settings.onTimerSchedule||void 0===t.settings.onTimerSchedule?0:t.settings.onTimerSchedule.length),u=0,s=0;s<o.length;s++)if(null!==t.settings.onTimerSchedule[s]&&void 0!==t.settings.onTimerSchedule[s]){if(o[u]={hour:0,minute:0,week:0,inputSource:0},3===i.webOSVer){var f=t.settings.onTimerSchedule[s].weekday;if(f%2){var a=f%2;f=64+(f-a)/2}else f/=2}else f=t.settings.onTimerSchedule[s].weekday;o[u].hour=t.settings.onTimerSchedule[s].hour,o[u].minute=t.settings.onTimerSchedule[s].minute,o[u].week=f;var l="ext://",m=t.settings.onTimerSchedule[s].input.toUpperCase(),c="1";!1===isNaN(m.substring(m.length-1,m.length))&&(c=m.substring(m.length-1,m.length),m=m.substring(0,m.length-1)),m=m.split("/")[0],l="DISPLAYPORT"===m.toUpperCase()?l+"dp:"+c:l+m.toLowerCase()+":"+c,o[u++].inputSource=l}r.timerList=o,"function"==typeof n&&n(r)})},onFailure:function(n){e("getOnTimerList: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PGOTL","Power.getOnTimerList returns failure."),i(n))}})}),e("Power.getOnTimerList Done")},s.prototype.getOffTimerList=function(n,i){e("getOffTimerList: "),r(function(o){4===o.webOSVer||o.webOSVer>4?f.Request("luna://com.webos.service.commercial.scapadapter/settings/",{method:"get",parameters:{category:"commercial",keys:["onOffTimeSchedule"]},onSuccess:function(e){if(!0===e.returnValue){for(var t={},i=new Array(null===e.settings.onOffTimeSchedule.offTime||void 0===e.settings.onOffTimeSchedule.offTime?0:e.settings.onOffTimeSchedule.offTime.length),r=0,o=0;o<i.length;o++,r++)if(null!==e.settings.onOffTimeSchedule.offTime[o]&&void 0!==e.settings.onOffTimeSchedule.offTime[o]){i[r]={hour:0,minute:0,week:0};for(var u=e.settings.onOffTimeSchedule.offTime[o].day,s=0,f=0;f<u.length;f++)"mon"===u[f]&&(s+=1),"tue"===u[f]&&(s+=2),"wed"===u[f]&&(s+=4),"thu"===u[f]&&(s+=8),"fri"===u[f]&&(s+=16),"sat"===u[f]&&(s+=32),"sun"===u[f]&&(s+=64);i[r].hour=e.settings.onOffTimeSchedule.offTime[o].hour,i[r].minute=e.settings.onOffTimeSchedule.offTime[o].minute,i[r].week=s}t.timerList=i,"function"==typeof n&&n(t)}},onFailure:function(n){e("getOffTimerList: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PGOTL","Power.getOffTimerList returns failure."),i(n))}}):f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["offTimerSchedule"]},onSuccess:function(t){e("getOffTimerList: On Success"),r(function(i){if(e("version : "+i.webOSVer),!0===t.returnValue){var r={};"string"==typeof t.settings.offTimerSchedule&&(t.settings.offTimerSchedule=JSON.parse(t.settings.offTimerSchedule));for(var o=new Array(null===t.settings.offTimerSchedule||void 0===t.settings.offTimerSchedule?0:t.settings.offTimerSchedule.length),u=0,s=0;s<o.length;s++)if(null!==t.settings.offTimerSchedule[s]&&void 0!==t.settings.offTimerSchedule[s]){if(o[u]={hour:0,minute:0,week:0},3===i.webOSVer){var f=t.settings.offTimerSchedule[s].weekday;if(f%2){var a=f%2;f=64+(f-a)/2}else f/=2}else f=t.settings.offTimerSchedule[s].weekday;o[u].hour=t.settings.offTimerSchedule[s].hour,o[u].minute=t.settings.offTimerSchedule[s].minute,o[u++].week=f}r.timerList=o,"function"==typeof n&&n(r)}})},onFailure:function(n){e("getOffTimerList: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PGOTL","Power.getOffTimerList returns failure."),i(n))}})}),e("Power.getOffTimerList Done")},s.prototype.setDisplayMode=function(n,u,a){e("setDisplayMode: "+JSON.stringify(a));var l=null;switch(a.displayMode){case s.DisplayMode.DISPLAY_OFF:l="turnOffScreen";break;case s.DisplayMode.DISPLAY_ON:l="turnOnScreen";break;default:if("function"==typeof u){var m={};t(m,"PSDM","Power.setDisplayMode returns failure. Invalid option value."),u(m)}return}if(e("setDisplayMode: "+l),null===l&&"function"==typeof u){var m={};return t(m,"PSDM","Power.setDisplayMode returns failure. command was not defined."),u(m),void e("Power.setDisplayMode invalid ")}r(function(r){4===r.webOSVer||r.webOSVer>4?f.Request("luna://com.webos.service.commercial.scapadapter/power",{method:"setDisplayMode",parameters:{displayMode:a.displayMode},onSuccess:function(t){e("setDisplayMode: On Success"),delete t.returnValue,!0===t.returnValue&&"function"==typeof n&&n(t)},onFailure:function(e){delete e.returnValue,"function"==typeof o&&(i(e,"PSDM","Power.setDisplayMode returns failure."),o(e))}}):f.Request("luna://com.webos.service.tv.signage/",{method:"getPowerState",onSuccess:function(i){if(e("setDisplayMode: On Success"),!0===i.returnValue&&i.state===a.displayMode)return void("function"==typeof n&&(e("setDisplayMode: no need to do any action."),n()));f.Request("luna://com.webos.service.tv.signage/",{method:l,onSuccess:function(t){e("setDisplayMode: On Success"),!0===t.returnValue&&"function"==typeof n&&n()},onFailure:function(n){e("setDisplayMode: On Failure"),delete n.returnValue,"function"==typeof u&&(t(n,"PSDM","Power.setDisplayMode returns failure."),u(n))}})},onFailure:function(n){e("setDisplayMode: On Failure 2"),delete n.returnValue,"function"==typeof u&&(t(n,"PSDM","Power.setDisplayMode returns failure."),u(n))}})}),e("Power.setDisplayMode Done")},s.prototype.executePowerCommand=function(n,i,o){if(e("executePowerCommand: "+JSON.stringify(o)),void 0===o.powerCommand||"string"!=typeof o.powerCommand||null===o.powerCommand||o.powerCommand.length<=0){if("function"==typeof i){var u={};t(u,"PEPM","Power.executePowerCommand returns failure. invalid argument or out of range. "),i(u)}}else{if(o.powerCommand!==s.PowerCommand.REBOOT&&o.powerCommand!==s.PowerCommand.SHUTDOWN){var u={};return t(u,"PEPM","Power.executePowerCommand returns failure. invalid argument."),void i(u)}r(function(r){4===r.webOSVer||r.webOSVer>4?f.Request("luna://com.webos.service.commercial.scapadapter/power",{method:"executePowerCommand",parameters:{powerCommand:o.powerCommand},onSuccess:function(t){e("executePowerCommand: On Success"),!0===t.returnValue&&"function"==typeof n&&n()},onFailure:function(n){e("executePowerCommand: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PEPM","Power.executePowerCommand returns failure."),i(n))}}):f.Request("luna://com.webos.service.tv.signage/",{method:o.powerCommand,parameters:{reason:"unknown"},onSuccess:function(t){e("executePowerCommand: On Success"),!0===t.returnValue&&"function"==typeof n&&n()},onFailure:function(n){e("executePowerCommand: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PEPM","Power.executePowerCommand returns failure."),i(n))}})}),e("Power.executePowerCommand Done")}},s.prototype.setDPMWakeup=function(n,i,r){var o=null;switch(r.dpmSignalType){case s.DPMSignalType.CLOCK:o="clock";break;case s.DPMSignalType.CLOCK_WITH_DATA:o="clockAndData"}if(e("setDPMWakeup: "+o),null===o&&"function"==typeof i){var u={};return t(u,"PSDW","Power.setDPMWakeup returns failure. command was not defined."),i(u),void e("Power.setDPMWakeup invalid ")}f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{dpmWakeUpControl:o}},onSuccess:function(t){e("setDPMWakeup: On Success"),!0===t.returnValue&&"function"==typeof n&&n()},onFailure:function(n){e("setDPMWakeup: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PSDW","Power.setDPMWakeup returns failure."),i(n))}}),e("Power.setDPMWakeup Done")},s.prototype.getDPMWakeup=function(n,i){e("getDPMWakeup: "),f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["dpmWakeUpControl"]},onSuccess:function(t){if(e("getDPMWakeup: On Success"),!0===t.returnValue){var i={};i.dpmSignalType=t.settings.dpmWakeUpControl,"function"==typeof n&&n(i)}},onFailure:function(n){e("getDPMWakeup: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PGDW","Power.getDPMWakeup returns failure."),i(n))}}),e("Power.getDPMWakeup Done")},s.prototype.setPMMode=function(n,i,r){var o=null;switch(r.mode){case s.PMMode.PowerOff:o="powerOff";break;case s.PMMode.SustainAspectRatio:o="sustainAspectRatio";break;case s.PMMode.ScreenOff:o="screenOff";break;case s.PMMode.ScreenOffAlways:o="screenOffAlways";break;case s.PMMode.ScreenOffBacklight:o="screenOffBacklight"}if(e("setPMMode: "+o),null===o&&"function"==typeof i){var u={};return t(u,"PSPM","Power.setPMMode returns failure. command was not defined."),i(u),void e("Power.setPMMode invalid ")}f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{pmMode:o}},onSuccess:function(t){e("setPMMode: On Success"),!0===t.returnValue&&"function"==typeof n&&n()},onFailure:function(n){e("setPMMode: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PSPM","Power.setPMMode returns failure."),i(n))}}),e("Power.setPMMode Done")},s.prototype.getPMMode=function(n,i){e("getPMMode: "),f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["pmMode"]},onSuccess:function(t){if(e("getPMMode: On Success"),!0===t.returnValue){var i={};i.mode=t.settings.pmMode,"function"==typeof n&&n(i)}},onFailure:function(n){e("getPMMode: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PGPM","Power.getPMMode returns failure."),i(n))}}),e("Power.getPMMode Done")},s.prototype.setPowerOnDelay=function(n,i,r){if(e("setPowerOnDelay: "+r.delayTime),null===r.delayTime&&"function"==typeof i){var o={};return t(o,"PSPD","Power.setPowerOnDelay returns failure. command was not defined."),i(o),void e("Power.setPowerOnDelay invalid ")}if("number"!=typeof r.delayTime){var o={};return t(o,"PSPD","Power.setPowerOnDelay returns failure. delayTime is not a number."),i(o),void e("Power.setPowerOnDelay invalid type")}if(r.delayTime<0||r.delayTime>250){var o={};return t(o,"PSPD","Power.setPowerOnDelay returns failure. Out of range."),i(o),void e("Power.setPowerOnDelay invalid range")}f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"set",parameters:{category:"commercial",settings:{powerOnDelay:r.delayTime}},onSuccess:function(t){e("setPowerOnDelay: On Success"),!0===t.returnValue&&"function"==typeof n&&n()},onFailure:function(n){e("setPowerOnDelay: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PSPD","Power.setPowerOnDelay returns failure."),i(n))}}),e("Power.setPowerOnDelay Done")},s.prototype.getPowerOnDelay=function(n,i){e("getPowerOnDelay: "),f.Request("luna://com.webos.service.commercial.signage.storageservice/settings/",{method:"get",parameters:{category:"commercial",keys:["powerOnDelay"]},onSuccess:function(t){if(e("getPowerOnDelay: On Success"),!0===t.returnValue){var i={};i.delayTime=t.settings.powerOnDelay,"function"==typeof n&&n(i)}},onFailure:function(n){e("getPowerOnDelay: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"PGPD","Power.getPowerOnDelay returns failure."),i(n))}}),e("Power.getPowerOnDelay Done")},s.prototype.getOnOffTimeSchedule=function(n,i){e("getOnOffTimeSchedule: "),f.Request("luna://com.webos.service.commercial.signage.storageservice/",{method:"getOnOffTimeSchedule",parameters:{},onSuccess:function(t){if(e("getOnOffTimeSchedule: On Success"),!0===t.returnValue&&"function"==typeof n){var i={};i.onOffTimeScheduleList=t.settings.onOffTimeSchedule,"function"==typeof n&&n(i)}},onFailure:function(n){e("getOnOffTimeSchedule: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"TGAS","Power.getOnOffTimeSchedule returns failure."),i(n))}}),e("Power.getOnOffTimeSchedule Done")},s.prototype.setOnOffTimeSchedule=function(n,i,r){e("setOnOffTimeSchedule: "),f.Request("luna://com.webos.service.commercial.signage.storageservice/",{method:"setOnOffTimeSchedule",parameters:r,onSuccess:function(t){e("setOnOffTimeSchedule: On Success"),!0===t.returnValue&&"function"==typeof n&&"function"==typeof n&&n()},onFailure:function(n){e("setOnOffTimeSchedule: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"TGAS","Power.setOnOffTimeSchedule returns failure."),i(n))}}),e("Power.setOnOffTimeSchedule Done")},s.prototype.unsetOnOffTimeSchedule=function(n,i){e("unsetOnOffTimeSchedule: "),f.Request("luna://com.webos.service.commercial.signage.storageservice/",{method:"unsetOnOffTimeSchedule",parameters:{},onSuccess:function(t){e("unsetOnOffTimeSchedule: On Success"),!0===t.returnValue&&"function"==typeof n&&"function"==typeof n&&n()},onFailure:function(n){e("unsetOnOffTimeSchedule: On Failure"),delete n.returnValue,"function"==typeof i&&(t(n,"TGAS","Power.unsetOnOffTimeSchedule returns failure."),i(n))}}),e("Power.unsetHolidaySchedule Done")},s}();